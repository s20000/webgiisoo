(function(a){a.fn.dictpicker=function(e){var c=a("#dict-picker");if(c.length==0){c=a("<div id='dict-picker' class='picker'></div>");a("body").append(c);}c.click(function(b){b.stopPropagation();});a("body").click(function(){c.hide();});var d=this;d.attr("readonly","readonly");d.addClass("dictpicker-node");d.each(function(b,f){var f=a(f);f.css("color","rgba(0,0,0,0)");var g=a("<span class='mark'></span>");g.css("left",f.position().left+"px");g.css("top",f.position().top+"px");g.css("height",f.height()+"px");g.css("width",(f.width()-10)+"px");g.css("line-height",f.height()+"px");f.parent().append(g);});d.attr("href","#dict-picker");d.leanModal();d.click(function(g){var f=a(this);c.html('<img src="/images/loading2.gif"/>');var b=f.prop("multiple");if(typeof(e)=="function"){e(f,function(j){var i="";if((!j)||j.length==0){i="没有数据项...";}else{a(j).each(function(k,l){if(b){i+="<div class='item' value='"+l.value+"'><label><input type='checkbox' value='"+l.value+"'/><span>"+l.name+"</span></label></div>";}else{i+="<div class='item' value='"+l.value+"'><span>"+l.name+"</span></div>";}});i="<div class='picker_class'>"+i+"</div>";if(b){i+='<div class="btns"><a class="ok" href="javascript:;">确定</a><a class="clear" href="javascript:;">清空</a></div>';}else{i+='<div class="btns"><a class="clear" href="javascript:;">清空</a></div>';}}c.html(i);c.find(".picker_class").jScrollPane();var h=c.find(".item");h.bind("mouseenter",function(){a(this).addClass("hover");});h.bind("mouseleave",function(){a(this).removeClass("hover");});if(b){var i=f.val();a(i.split(",")).each(function(k,m){var l=c.find('input[value="'+m+'"]');if(l.length>0){l[0].checked=true;}});}else{var i=f.val();c.find('.item[value="'+i+'"]').addClass("selected");h.click(function(){f.attr("value",a(this).attr("value"));var l=a(this).find("span").text();var k=f.parent().find("span.mark");k.html("<span>"+l+"</span>");if(!k.hasClass("hint")){k.addClass("hint hint--bottom");}k.attr("data-hint",l);f.trigger("blur");a("#lean_overlay").click();});}c.find(".btns a").click(function(){if(a(this).attr("class")=="ok"){var l="";var m="";c.find("input:checked").each(function(n,o){if(l.length>0){l+=",";m+=",";}l+=o.value;m+=a(o).parent().find("span").text();});f.attr("value",l);var k=f.parent().find("span.mark");k.html("<span>"+m+"</span>");if(!k.hasClass("hint")){k.addClass("hint hint--bottom");}k.attr("data-hint",m);a("#lean_overlay").click();f.trigger("blur");}else{f.attr("value","");var k=f.parent().find("span.mark");k.html("");k.removeClass("hint hint--bottom");k.removeAttr("data-hint");a("#lean_overlay").click();}});});}g.stopPropagation();});setTimeout(function(){d.each(function(f,h){if(h.value!=""){var g=a(h);var b=h.value.split(",");if(typeof(e)=="function"){e(g,function(k){var j="";a(k).each(function(l,m){a(b).each(function(n,o){if(o==m.value){if(j.length>0){j+=",";}j+=m.name;}});});var i=g.parent().find("span.mark");i.html("<span>"+j+"</span>");if(!i.hasClass("hint")){i.addClass("hint hint--bottom");}i.attr("data-hint",j);},h.value);}}});},100);};})(jQuery);